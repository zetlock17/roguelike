import os
import time
import random
from colorama import Fore, Back, Style, init


from input_handler import get_char



ITALIC_ON = "\033[3m"
ITALIC_OFF = "\033[23m"
subtitle = Fore.RED + Style.DIM
reset = Fore.RESET + Style.RESET_ALL
gun = Fore.YELLOW + Style.DIM


def show_title_screen():
    os.system('cls' if os.name == 'nt' else 'clear')
        
    print("█▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀█")
    print("█                                                                                                              █")
    print("█                                ███████╗███████╗ ██████╗ █████╗ ██████╗ ███████╗                              █")
    print("█                                ██╔════╝██╔════╝██╔════╝██╔══██╗██╔══██╗██╔════╝                              █")
    print("█                                █████╗  ███████╗██║     ███████║██████╔╝█████╗                                █")
    print("█                                ██╔══╝  ╚════██║██║     ██╔══██║██╔═══╝ ██╔══╝                                █")
    print("█                                ███████╗███████║╚██████╗██║  ██║██║     ███████╗                              █")
    print("█                                ╚══════╝╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝     ╚══════╝                              █")
    print("█                                                                                                              █")
    print("█                                                                                                              █")
    print("█                                                                                                              █")
    print("█                                                                                                              █")
    print("█"+ITALIC_ON+"                                Вы - серийный убийца на пожизненном заключении"+ITALIC_OFF+"                                █")
    print("█"+ITALIC_ON+"                          В тюрьме произошел сбой, открывший все двери, кроме одной..."+ITALIC_OFF+"                        █")
    print("█"+ITALIC_ON+"                           Найди три ключа и соверши побег. Но будет ли это так легко?"+ITALIC_OFF+"                        █")
    print("█                                                                                                              █")
    print("█                                                                                                              █")
    print("█                                                                                                              █")
    print("█                                                     .-.                                                      █")
    print("█                                                    (҂""\033[31m`\033[0m""_""\033[31m´\033[0m"")                                                    █")
    print("█                                                   <,""\033[38;5;130m︻\033[0m""\033[30m╦╤\033[0m""\033[38;5;130m─\033[0m""💥                                                  █")
    print("█                                                    _/ \_                                                     █")
    print("█                                                                                                              █")
    print("█                                         ▄█▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀█▄                                         █")
    print("█                                       ▄█▀                          ▀█▄                                       █")
    print("█                                     ▄█▀"+subtitle+"     НАЖМИТЕ ЛЮБУЮ КЛАВИШУ    "+reset+"▀█▄                                     █")
    print("▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀                                  ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀")

    
    get_char()




def transition_to_game():
    title_screen_lines = [
        "█▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀█",
        "█                                                                                                              █",
        "█                                ███████╗███████╗ ██████╗ █████╗ ██████╗ ███████╗                              █",
        "█                                ██╔════╝██╔════╝██╔════╝██╔══██╗██╔══██╗██╔════╝                              █",
        "█                                █████╗  ███████╗██║     ███████║██████╔╝█████╗                                █",
        "█                                ██╔══╝  ╚════██║██║     ██╔══██║██╔═══╝ ██╔══╝                                █",
        "█                                ███████╗███████║╚██████╗██║  ██║██║     ███████╗                              █",
        "█                                ╚══════╝╚══════╝ ╚═════╝╚═╝  ╚═╝╚═╝     ╚══════╝                              █",
        "█                                                                                                              █",
        "█                                                                                                              █",
        "█                                                                                                              █",
        "█                                                                                                              █",
        "█"+ITALIC_ON+"                                Вы - серийный убийца на пожизненном заключении"+ITALIC_OFF+"                                █",
        "█"+ITALIC_ON+"                          В тюрьме произошел сбой, открывший все двери, кроме одной..."+ITALIC_OFF+"                        █",
        "█"+ITALIC_ON+"                           Найди три ключа и соверши побег. Но будет ли это так легко?"+ITALIC_OFF+"                        █",
        "█                                                                                                              █",
        "█                                                                                                              █",
        "█                                                                                                              █",
        "█                                                     .-.                                                      █",
        "█                                                    (҂""\033[31m`\033[0m""_""\033[31m´\033[0m"")                                                    █",
        "█                                                   <,""\033[38;5;130m︻\033[0m""\033[30m╦╤\033[0m""\033[38;5;130m─\033[0m""💥                                                  █",
        "█                                                    _/ \_                                                     █",
        "█                                                                                                              █",
        "█                                         ▄█▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀█▄                                         █",
        "█                                       ▄█▀                          ▀█▄                                       █",
        "█                                     ▄█▀"+subtitle+"     НАЖМИТЕ ЛЮБУЮ КЛАВИШУ    "+reset+"▀█▄                                     █",
        "▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀                                  ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀"
    ] 

    def clear_screen():
        os.system('cls' if os.name == 'nt' else 'clear')

    for step in range(20):
        clear_screen()
        for line in title_screen_lines:
            faded_line = ""
            for char in line:
                # Случайное удаление символов с увеличивающейся вероятностью
                if random.random() < step * 0.05:
                    faded_line += " "
                else:
                    faded_line += char
            # Добавляем легкое "размытие" цветом
            if step > 10:
                print(Fore.LIGHTBLACK_EX + Style.DIM + faded_line + Style.RESET_ALL)
            else:
                print(faded_line)
        time.sleep(0.03)

    # Финальная стадия: плавное затемнение
    for alpha in range(10, -1, -1):
        clear_screen()
        for line in title_screen_lines:
            # Полное исчезновение с эффектом прозрачности
            if random.random() < alpha / 10:
                print(Fore.LIGHTBLACK_EX + Style.DIM + line + Style.RESET_ALL)
            else:
                print(" " * len(line))
        time.sleep(0.05)

    clear_screen()